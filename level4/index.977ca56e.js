function $parcel$export(e,t,r,n){Object.defineProperty(e,t,{get:r,set:n,enumerable:!0,configurable:!0})}var $parcel$global="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},$parcel$modules={},$parcel$inits={},parcelRequire=$parcel$global.parcelRequiredf3e;null==parcelRequire&&(parcelRequire=function(e){if(e in $parcel$modules)return $parcel$modules[e].exports;if(e in $parcel$inits){var t=$parcel$inits[e];delete $parcel$inits[e];var r={id:e,exports:{}};return $parcel$modules[e]=r,t.call(r.exports,r,r.exports),r.exports}var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n},parcelRequire.register=function(e,t){$parcel$inits[e]=t},$parcel$global.parcelRequiredf3e=parcelRequire),parcelRequire.register("b0KIW",(function(module,exports){var $4xklQ=parcelRequire("4xklQ"),$bsNDL=parcelRequire("bsNDL"),$7FzN9=parcelRequire("7FzN9"),$1M2iF=parcelRequire("1M2iF"),$4Bhaq=parcelRequire("4Bhaq");const sceneProperties={cancelExecution:!1,phase:0},editor=(0,$bsNDL.generateDefaultEditor)(document.getElementById("editorArea")),consoleElement=document.getElementById("consoleArea"),{renderer:renderer,scene:scene,camera:camera,controls:controls}=(0,$7FzN9.generateDefaultSceneObjects)(document.getElementById("phaseView")),gridMapHelper=new(0,$1M2iF.default),plane=gridMapHelper.createGridPlane(),actor=(0,$7FzN9.loadDefaultActor)();let objectives,walls,openDoors,doors,girarManivela,portaAberta,coletarCristal,resetLevel,winCondition;async function andarFrente(e){let t=e>10?10:e;await(0,$7FzN9.translateActor)(actor,t,gridMapHelper,sceneProperties,consoleElement)}async function andarTras(e){let t=e>10?10:e;await(0,$7FzN9.translateActor)(actor,-t,gridMapHelper,sceneProperties,consoleElement)}async function girarEsquerda(){await(0,$7FzN9.rotateActor)(actor,90,sceneProperties,1)}async function girarDireita(){await(0,$7FzN9.rotateActor)(actor,90,sceneProperties,-1)}async function darMeiaVolta(){await(0,$7FzN9.rotateActor)(actor,180,sceneProperties,1)}scene.add(plane),scene.add(actor);const phaseGeneration=[];function removeObjects(e,t){if(null!=e)for(let t=0;t<e.length;t++)scene.remove(e[t]);if(null!=t){for(let e=0;e<t.length;e++)scene.remove(t[e]);gridMapHelper.clearObstacles()}e=void 0,t=void 0,traps=void 0,lasers=void 0}function animate(){renderer.render(scene,camera),controls.update(),requestAnimationFrame(animate)}phaseGeneration.push((()=>{document.getElementById("phaseTitle").innerText="Nível 4 - Fase de Testes",document.getElementById("phaseObjective").innerText="Abra a porta, faça o robô chegar ao cristal, após isso, o colete.",camera.position.set(0,15,30),actor.position.set(gridMapHelper.getGlobalXPositionFromCoord(0),1,gridMapHelper.getGlobalZPositionFromCoord(5)),actor.rotation.set(0,(0,$7FzN9.degreeToRadians)(90),0),objectives=(0,$7FzN9.loadDefaultObjectives)(1),objectives[0].position.set(gridMapHelper.getGlobalXPositionFromCoord(9),0,gridMapHelper.getGlobalZPositionFromCoord(5)),gridMapHelper.addObstacle(9,9,5,5),scene.add(objectives[0]);const e=new $4xklQ.Mesh(new $4xklQ.BoxGeometry(.5,.5,1),new $4xklQ.MeshLambertMaterial({color:"rgb(255,0,255)"}));e.position.set(gridMapHelper.getGlobalXPositionFromCoord(4),1,gridMapHelper.getGlobalZPositionFromCoord(4.6)),scene.add(e),openDoors=[],doors=[],doors.push(new $4xklQ.Mesh(new $4xklQ.BoxGeometry(2,2,2),new $4xklQ.MeshLambertMaterial({color:"rgb(255,0,255)"}))),doors[0].position.set(gridMapHelper.getGlobalXPositionFromCoord(5),1,gridMapHelper.getGlobalZPositionFromCoord(5)),gridMapHelper.addObstacle(5,5,5,5),scene.add(doors[0]),openDoors.push(!1),walls=[];const t=new $4xklQ.BoxGeometry(18,2,2),r=new $4xklQ.MeshLambertMaterial({color:"rgb(0,255,0)"});walls.push(new $4xklQ.Mesh(t,r)),walls.push(new $4xklQ.Mesh(t,r)),walls[0].position.set(gridMapHelper.getGlobalXPositionFromCoord(5),1,gridMapHelper.getGlobalZPositionFromCoord(4)),walls[1].position.set(gridMapHelper.getGlobalXPositionFromCoord(5),1,gridMapHelper.getGlobalZPositionFromCoord(6)),scene.add(walls[0]),scene.add(walls[1]),gridMapHelper.addObstacle(1,9,4,4),gridMapHelper.addObstacle(1,9,6,6),portaFechada=()=>!sceneProperties.cancelExecution&&((0,$7FzN9.checkCollision)(actor.getObjectByName("interactionReference"),doors[0],gridMapHelper)?!openDoors[0]:(consoleElement.innerText+="É preciso estar perto de uma porta para usar este comando.\n",!1)),girarManivela=()=>new Promise((e=>{if(sceneProperties.cancelExecution&&e(),(0,$7FzN9.checkCollision)(actor.getObjectByName("interactionReference"),doors[0],gridMapHelper)){doors[0].position.y>=3?(openDoors[0]=!0,gridMapHelper.obstacles[1].active=!1,e()):requestAnimationFrame((function(){doors[0].translateY(.1),e()}))}})),coletarCristal=()=>{sceneProperties.cancelExecution||((0,$7FzN9.checkCollision)(actor.getObjectByName("interactionReference"),objectives[0],gridMapHelper)?(objectives[0].visible=!1,consoleElement.innerText+="Cristal coletado com sucesso.\n",gridMapHelper.obstacles[0].active=!1):consoleElement.innerText+="Robô não está em frente ao cristal.\n")},resetLevel=()=>{actor.position.set(gridMapHelper.getGlobalXPositionFromCoord(0),1,gridMapHelper.getGlobalZPositionFromCoord(5)),actor.rotation.set(0,(0,$7FzN9.degreeToRadians)(90),0),actor.getObjectByName("eve").rotation.set(0,0,0),objectives[0].visible=!0,doors[0].position.set(gridMapHelper.getGlobalXPositionFromCoord(5),1,gridMapHelper.getGlobalZPositionFromCoord(5)),gridMapHelper.obstacles[0].active=!0,gridMapHelper.obstacles[1].active=!0},winCondition=()=>!objectives[0].visible})),window.addEventListener("resize",(()=>{(0,$7FzN9.resizeCanvasToDisplaySize)(renderer,camera)}));const execBtn=document.getElementById("execBtn");execBtn.addEventListener("click",(async function(){const codeParsed=(0,$4Bhaq.default)(editor.state.doc.toString());console.log(codeParsed),sceneProperties.cancelExecution=!1,null!=codeParsed&&(resetLevel(),this.disabled=!0,await eval(codeParsed),winCondition()?($bsNDL.readOnlyState.doc=editor.state.doc,editor.setState($bsNDL.readOnlyState),document.getElementById("winMessage").classList.remove("invisible"),document.getElementById("advanceBtn").classList.remove("invisible"),document.getElementById("resetBtn").disabled=!0):(sceneProperties.executing=!1,this.disabled=!1))}));const resetBtn=document.getElementById("resetBtn");resetBtn.addEventListener("click",(()=>{sceneProperties.cancelExecution=!0,resetLevel()}));const advanceBtn=document.getElementById("advanceBtn");advanceBtn.addEventListener("click",(e=>{sceneProperties.phase++,sceneProperties.phase<phaseGeneration.length?(removeObjects(objectives,walls),phaseGeneration[sceneProperties.phase](),editor.setState($bsNDL.editState),consoleElement.innerText=null,document.getElementById("winMessage").classList.add("invisible"),document.getElementById("advanceBtn").classList.add("invisible"),execBtn.disabled=!1,resetBtn.disabled=!1):(sceneProperties.phase=sceneProperties.phase>phaseGeneration.length?phaseGeneration.length:sceneProperties.phase,window.location.href="../")})),(0,$7FzN9.resizeCanvasToDisplaySize)(renderer,camera),phaseGeneration[sceneProperties.phase](),animate()})),parcelRequire.register("4Bhaq",(function(e,t){$parcel$export(e.exports,"default",(()=>p));const r=[{filter:new RegExp("^andarFrente(\\s+)?\\((\\s+)?(0|[1-9][0-9]*)(\\s+)?\\)(\\s+)?(;)?$"),type:"sequential"},{filter:new RegExp("^andarTras(\\s+)?\\((\\s+)?(0|[1-9][0-9]*)(\\s+)?\\)(\\s+)?(;)?$"),type:"sequential"},{filter:new RegExp("^girarEsquerda(\\s+)?\\((\\s+)?\\)(\\s+)?(;)?$"),type:"sequential"},{filter:new RegExp("^girarDireita(\\s+)?\\((\\s+)?\\)(\\s+)?(;)?$"),type:"sequential"},{filter:new RegExp("^darMeiaVolta(\\s+)?\\((\\s+)?\\)(\\s+)?(;)?$"),type:"sequential"},{filter:new RegExp("^coletarCristal(\\s+)?\\((\\s+)?\\)(\\s+)?(;)?$"),type:"normal"},{filter:new RegExp("^desativarLaserAzul(\\s+)?\\((\\s+)?\\)(\\s+)?(;)?$"),type:"mustCondition"},{filter:new RegExp("^desativarLaserVermelho(\\s+)?\\((\\s+)?\\)(\\s+)?(;)?$"),type:"mustCondition"},{filter:new RegExp("^se(\\s+)?\\((\\s+)?.+\\)$"),type:"conditional"},{filter:new RegExp("^se(\\s+)?\\((\\s+)?.+\\)(\\s+)?{$"),type:"conditional&&blockValidation"},{filter:new RegExp("^senão$"),type:"elseValidation"},{filter:new RegExp("^senão(\\s+)?{$"),type:"elseValidation&&blockValidation"},{filter:new RegExp("^}$"),type:"closeBlockValidation"},{filter:new RegExp("^{$"),type:"blockValidation"},{filter:new RegExp("^enquanto(\\s+)?\\((\\s+)?.+\\)$"),type:"loop"},{filter:new RegExp("^enquanto(\\s+)?\\((\\s+)?.+\\)(\\s+)?{$"),type:"loop&&blockValidation"},{filter:new RegExp("^girarManivela(\\s+)?\\((\\s+)?\\)(\\s+)?(;)?$"),type:"sequential"}],n=[new RegExp("true"),new RegExp("false"),new RegExp("^laserAzulAtivo(\\s+)?\\((\\s+)?\\)(\\s+)?$"),new RegExp("^laserVermelhoAtivo(\\s+)?\\((\\s+)?\\)(\\s+)?$"),new RegExp("^portaFechada(\\s+)?\\((\\s+)?\\)(\\s+)?$")];function o(e){let t=e.trim(),r=e.substring(t.indexOf("(")+1,t.lastIndexOf(")"));for(let e=0;e<n.length;e++)if(n[e].test(r.trim()))return!0;return!1}function i(e,t){let r=!1,n=0;for(let o=t+1;o<e.length;o++)if(e[o].includes("}")){if(0==n){r=!0;break}n--}else{if(!e[o].includes("{"))continue;n++}return r}function s(e,t){let r=!1;for(let n=t-1;n>=0;n--)if(e[n].includes("{")){r=!0;break}return r}function a(e,t){let r=!1,n=new RegExp("^se(\\s+)?\\((\\s+)?.+\\)(\\s+)?(\\s+)?$"),o=new RegExp("^se(\\s+)?\\((\\s+)?.+\\)$"),i=new RegExp("^se(\\s+)?\\((\\s+)?.+\\)(\\s+)?{[^}]*?$"),s=new RegExp("^se(\\s+)?\\((\\s+)?.+\\)(\\s+)?{$"),a=new RegExp("^senão$"),l=new RegExp("^senão(\\s+)?{$"),c=new RegExp("^senão(\\s+)?.+(\\s+)?$"),d=new RegExp("^senão(\\s+)?{[^]*?$"),p=null;for(let r=t-1;r>=0;r--)if(o.test(e[r].trim())||s.test(e[r].trim())||a.test(e[r].trim())||l.test(e[r].trim())){p=r;break}if(null!=p){let o="";for(let r=p;r<t;r++)o+=`${e[r].trim()}\n`;return n.test(o.trim())||i.test(o.trim())||c.test(o.trim())||d.test(o.trim())?(r=!0,r):r}return r}function l(e,t){let r=!1,n=new RegExp("^se(\\s+)?\\((\\s+)?.+\\)(\\s+)?.+(\\s+)?$"),o=new RegExp("^se(\\s+)?\\((\\s+)?.+\\)$"),i=new RegExp("^se(\\s+)?\\((\\s+)?.+\\)(\\s+)?{[^]*?}$"),s=new RegExp("^se(\\s+)?\\((\\s+)?.+\\)(\\s+)?{$"),a=null;for(let r=t-1;r>=0;r--)if(o.test(e[r].trim())||s.test(e[r].trim())){a=r;break}if(null!=a){let o="";for(let r=a;r<t;r++)o+=`${e[r].trim()}\n`;return n.test(o.trim())||i.test(o.trim())?(r=!0,r):r}return r}function c(e,t){const r=[new RegExp("^andarFrente(\\s+)?\\((\\s+)?\\d+(\\s+)?\\)(\\s+)?(;)?$"),new RegExp("^andarTras(\\s+)?\\((\\s+)?\\d+(\\s+)?\\)(\\s+)?(;)?$"),new RegExp("^girarEsquerda(\\s+)?\\((\\s+)?\\)(\\s+)?(;)?$"),new RegExp("^girarDireita(\\s+)?\\((\\s+)?\\)(\\s+)?(;)?$"),new RegExp("^darMeiaVolta(\\s+)?\\((\\s+)?\\)(\\s+)?(;)?$")];let n=[0,5],o=0,i="+",s=0;function a(e){return[{axis:0,value:"+"},{axis:1,value:"+"},{axis:0,value:"-"},{axis:1,value:"-"}][e]}function l(e){return e>3?0:e<0?3:e}for(let c=0;c<t;c++)if(r[0].test(e[c])){let t=parseInt(e[c].substring(e[c].indexOf("(")+1,e[c].indexOf(")")));"+"==i?n[o]+=t:n[o]-=t}else if(r[1].test(e[c])){let t=parseInt(e[c].substring(e[c].indexOf("(")+1,e[c].indexOf(")")));"-"==i?n[o]+=t:n[o]-=t}else if(r[2].test(e[c])){s--,s=l(s);const e=a(s);o=e.axis,i=e.value}else if(r[3].test(e[c])){s++,s=l(s);const e=a(s);o=e.axis,i=e.value}else{if(!r[4].test(e[c]))continue;{s--,s=l(s),s--,s=l(s);const e=a(s);o=e.axis,i=e.value}}return"+"==i?n[o]++:n[o]--,n}function d(e,t){document.getElementById("consoleArea").innerText+=`Código inválido: ${e} linha: ${t}\n`}function p(e,t=0){let n="async function runCode(){\n",p="\n",u=e.split("\n"),g=!0,f=0;for(let e=0;e<u.length;e++){let m,$=!1;if(""!=u[e].trim()){for(let t=0;t<r.length;t++)if($=r[t].filter.test(u[e].trim()),$){m=r[t].type;break}if(!$){d(u[e],e+1),g=!1;break}if("sequential"===m){n+=`await ${u[e].trim()}\n`,f++}else if("conditional&&blockValidation"===m){let t=!1;if(i(u,e)?o(u[e])?t=!0:d(`${u[e]} (Condição inválida)`,e+1):d(`${u[e]} (Bloco é aberto mas nunca é fechado)`,e+1),!t){g=!1;break}{let t=u[e].trim();n+=`if${t.substring(t.indexOf("("))}\n`,f++}}else if("conditional"===m){if(!o(u[e])){d(`${u[e]} (Condição inválida)`,e+1),g=!1;break}{let t=u[e].trim();n+=`if${t.substring(t.indexOf("("))}\n`,f++}}else if("elseValidation"===m){if(!l(u,e)){d(`${u[e]} (Condição inválida)`,e+1),g=!1;break}n+="else\n",f++}else if("elseValidation&&blockValidation"===m){let t=!1;if(i(u,e)?l(u,e)?t=!0:d(`${u[e]} (Condição inválida)`,e+1):d(`${u[e]} (Bloco é aberto mas nunca é fechado)`,e+1),!t){g=!1;break}n+="else{\n",f++}else if("blockValidation"===m){if(!i(u,e)){d(`${u[e]} (Bloco é aberto mas nunca é fechado)`,e+1),g=!1;break}n+=`${u[e].trim()}\n`,f++}else if("closeBlockValidation"===m){if(!s(u,e)){d(`${u[e]} (Bloco é fechado mas nunca é aberto)`,e+1),g=!1;break}n+=`${u[e].trim()}\n`,f++}else if("mustCondition"===m)if(a(u,e)){n+=`${u[e].trim()}\n`,f++}else{let t=r[6].filter.test(u[e].trim())?"blue":"red",o=c(u,e);p+=`badLuck([${o[0]},${o[1]}],'${t}')\n`,n+=`${u[e].trim()}\n`,f++}else if("loop"===m){if(!o(u[e])){d(`${u[e]} (Condição inválida)`,e+1),g=!1;break}{let t=u[e].trim();n+=`while${t.substring(t.indexOf("("))}\n`,f++}}else if("loop&&blockValidation"===m){let t=!1;if(i(u,e)?o(u[e])?t=!0:d(`${u[e]} (Condição inválida)`,e+1):d(`${u[e]} (Bloco é aberto mas nunca é fechado)`,e+1),!t){g=!1;break}{let t=u[e].trim();n+=`while${t.substring(t.indexOf("("))}\n`,f++}}else{n+=`${u[e].trim()}\n`,f++}if(t>0&&f>t){document.getElementById("consoleArea").innerText+=`Aviso: O código tem mais linhas do que o robô pode processar. Tente rescrever seu código em ${t} linhas ou menos.\n`,g=!1;break}}}return g?(n+=`}${p}runCode()\n`,n):null}})),parcelRequire("b0KIW");